{{- $db_type := printf "pdo_%s" (.Values.db.type | default "mysql") | toString | b64enc }}
{{- $db_name := .Values.db.name | toString | b64enc }}
{{- $db_user := .Values.db.user | toString | b64enc }}
{{- $db_password := .Values.db.password | toString | b64enc }}
{{- $db_host := .Values.db.host | toString | b64enc }}
{{- $db_port := .Values.db.port | default "3306" | toString | b64enc }}
{{- $secret := .Values.wallabag.secret | toString | b64enc }}
---
apiVersion: v1
kind: Secret
metadata:
  name: {{ .Release.Name }}-wallabag-secret
  labels:
    {{- include "wallabag.labels" . | nindent 4 }}
type: Opaque
data:
  DATABASE_CHARSET: {{ "utf8mb4" | toString | b64enc }}
  DATABASE_TABLE_PREFIX: {{ "wallabag_" | toString | b64enc }}
  DATABASE_DRIVER: {{ $db_type }}
  DATABASE_NAME: {{ $db_name }}
  DATABASE_USER: {{ $db_user }}
  DATABASE_PASSWORD: {{ $db_password }}
  DATABASE_HOST: {{ $db_host }}
  DATABASE_PORT: {{ $db_port }}
  SECRET: {{ $secret }}
